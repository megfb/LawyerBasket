<div class="posts-list-container">
  <div class="posts-list-header">
    <p-button
      label="Geri"
      icon="pi pi-arrow-left"
      [outlined]="true"
      [text]="true"
      (onClick)="goBack()"
      class="back-button"
    ></p-button>
    <h1 class="page-title">Beğendiğim Gönderiler</h1>
  </div>

  <p-card class="posts-list-card">
    @if (isLoadingLikedPosts) {
      <div class="loading-container">
        <p-progressSpinner></p-progressSpinner>
        <p>Beğendiğiniz gönderiler yükleniyor...</p>
      </div>
    } @else if (likedPostsError) {
      <div class="error-container">
        <p class="error-message">{{ likedPostsError }}</p>
      </div>
    } @else if (likedPosts.length === 0) {
      <div class="empty-container">
        <p class="empty-message">Henüz beğendiğiniz gönderi yok.</p>
      </div>
    } @else {
      <div class="posts-list">
        @for (post of likedPosts; track post.id) {
          <app-post-item
            [post]="post"
            [showDeleteButton]="false"
            [showLikeModal]="true"
            (postLiked)="onPostLiked($event)"
            (commentAdded)="onCommentAdded($event)"
            (commentDeleted)="onCommentDeleted($event)"
            (showLikes)="onShowLikes($event)"
          ></app-post-item>
        }
      </div>
    }
  </p-card>
  <p-confirmDialog></p-confirmDialog>
  <p-toast></p-toast>

  <!-- Likes Modal -->
  <p-dialog
    [(visible)]="showLikesModal"
    [modal]="true"
    [style]="{ width: '500px' }"
    [header]="'Beğenenler'"
    [closable]="true"
    [draggable]="false"
    [resizable]="false"
    (onHide)="onCloseLikesModal()"
  >
    @if (isLoadingLikes) {
      <div class="loading-container">
        <p-progressSpinner></p-progressSpinner>
        <p>Beğenen kullanıcılar yükleniyor...</p>
      </div>
    } @else if (likesError) {
      <div class="error-container">
        <p class="error-message">{{ likesError }}</p>
      </div>
    } @else if (currentPostLikes.length === 0) {
      <div class="empty-container">
        <p class="empty-message">Henüz beğenen kullanıcı yok.</p>
      </div>
    } @else {
      <div class="likes-list">
        @for (likeUser of currentPostLikes; track likeUser.likeId) {
          <div class="like-user-item">
            <div class="user-avatar-container">
              <img
                [src]="'/img/profilephoto.jpg?userId=' + likeUser.userId"
                [alt]="likeUser.firstName + ' ' + likeUser.lastName"
                class="user-avatar-image"
                (error)="onUserImageError($event, likeUser)"
              />
            </div>
            <div class="user-info">
              <p class="user-name">{{ likeUser.firstName }} {{ likeUser.lastName }}</p>
            </div>
          </div>
        }
      </div>
    }
  </p-dialog>
</div>

